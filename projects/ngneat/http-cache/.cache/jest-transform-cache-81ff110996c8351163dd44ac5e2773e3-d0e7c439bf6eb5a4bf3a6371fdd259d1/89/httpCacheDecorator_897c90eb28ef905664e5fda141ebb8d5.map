{"file":"C:\\Users\\Itay\\projects\\opensources\\http-cache\\projects\\ngneat\\http-cache\\src\\lib\\httpCacheDecorator.ts","mappings":";;AACA,4CAA6C;AAE7C,SAAgB,SAAS,CAAU,MAA2C,EAAE,GAAY;IAAzD,uBAAA,EAAA,WAAW,UAAU,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE;IAC5E,IAAM,KAAK,GAAG,IAAI,GAAG,EAAyB,CAAC;IAE/C,OAAO,UAAS,MAAW,EAAE,WAAmB,EAAE,UAA8B;QAC9E,IAAM,MAAM,GAAG,UAAU,CAAC,KAAK,CAAC;QAEhC,UAAU,CAAC,KAAK,GAAG;YACjB,IAAM,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;YACtC,IAAM,MAAM,GAAG,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YAE9B,IAAI,MAAM,EAAE;gBACV,OAAO,MAAM,CAAC;aACf;YAED,IAAM,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,IAAI,CAAC,uBAAW,CAAC,MAAM,CAAC,CAAC,CAAC;YACtE,KAAK,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;YACtB,IAAG,GAAG,EAAE;gBACN,UAAU,CAAC;oBACT,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;gBACpB,CAAC,EAAE,GAAG,CAAC,CAAC;aACT;YAED,OAAO,KAAK,CAAC;QACf,CAAC,CAAC;IACJ,CAAC,CAAC;AACJ,CAAC;AAzBD,8BAyBC","names":[],"sources":["C:\\Users\\Itay\\projects\\opensources\\http-cache\\projects\\ngneat\\http-cache\\src\\lib\\httpCacheDecorator.ts"],"sourcesContent":["import { Observable } from 'rxjs';\nimport { shareReplay } from 'rxjs/operators';\n\nexport function HttpCache<T = any>(config = { bufferSize: 1, refCount: false }, ttl?: number) {\n  const cache = new Map<string, Observable<T>>();\n\n  return function(target: any, propertyKey: string, descriptor: PropertyDescriptor) {\n    const method = descriptor.value;\n\n    descriptor.value = function(): Observable<T> {\n      const key = JSON.stringify(arguments);\n      const cached = cache.get(key);\n\n      if (cached) {\n        return cached;\n      }\n\n      const call$ = method.apply(this, arguments).pipe(shareReplay(config));\n      cache.set(key, call$);\n      if(ttl) {\n        setTimeout(() => {\n          cache.delete(key);\n        }, ttl);\n      }\n\n      return call$;\n    };\n  };\n}\n"],"version":3}