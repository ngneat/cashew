"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var httpCacheManager_service_1 = require("../httpCacheManager.service");
var mocks_spec_1 = require("./mocks.spec");
describe('HttpCacheManager', function () {
    var httpCache;
    var queue;
    var storage;
    var guard;
    var ttlManager;
    beforeEach(function () {
        queue = mocks_spec_1.requestQueue();
        storage = mocks_spec_1.httpCacheStorage();
        guard = mocks_spec_1.httpCacheGuard();
        ttlManager = mocks_spec_1.ttlManager();
        httpCache = new httpCacheManager_service_1.HttpCacheManager(queue, storage, guard, ttlManager, mocks_spec_1.config);
    });
    afterEach(function () {
        jest.clearAllMocks();
    });
    describe('validate', function () {
        var has;
        var isValid;
        var storageDelete;
        beforeEach(function () {
            has = spyOn(storage, 'has');
            isValid = spyOn(ttlManager, 'isValid');
            storageDelete = spyOn(storage, 'delete');
        });
        it('should return true when cache is valid', function () {
            has.and.returnValue(true);
            isValid.and.returnValue(true);
            expect(httpCache.validate('valid key')).toBeTruthy();
        });
        it('should return false when cache is invalid', function () {
            has.and.returnValue(true);
            isValid.and.returnValue(false);
            expect(httpCache.validate('invalid key')).toBeFalsy();
        });
        it('should return false when key is not exist', function () {
            has.and.returnValue(false);
            isValid.and.returnValue(true);
            expect(httpCache.validate('invalid key')).toBeFalsy();
        });
        it('should call delete from storage when key is valid', function () {
            has.and.returnValue(false);
            isValid.and.returnValue(false);
            httpCache.validate('valid key');
            expect(storage.delete).toHaveBeenCalledWith('valid key');
        });
    });
    describe('add', function () {
        it('should add key to bucket', function () {
            var bucket = mocks_spec_1.cacheBucket();
            spyOn(bucket, 'add');
            httpCache.add('key', {}, { bucket: bucket });
            expect(bucket.add).toHaveBeenCalledWith('key');
        });
        it('should set the key', function () {
            spyOn(storage, 'set');
            spyOn(ttlManager, 'set');
            spyOn(queue, 'delete');
            httpCache.add('key', {}, {});
            expect(storage.set).toHaveBeenCalled();
            expect(ttlManager.set).toHaveBeenCalled();
            expect(queue.delete).toHaveBeenCalled();
        });
    });
    describe('delete', function () {
        it('should delete the key from storage and ttl', function () {
            spyOn(storage, 'delete');
            spyOn(ttlManager, 'delete');
            httpCache.delete('key');
            expect(storage.delete).toHaveBeenCalledWith('key');
            expect(ttlManager.delete).toHaveBeenCalledWith('key');
        });
        it('should clear a given cache bucket', function () {
            var bucket = mocks_spec_1.cacheBucket();
            spyOn(bucket, 'clear');
            httpCache.delete(bucket);
            expect(bucket.clear).toHaveBeenCalled();
        });
        it('should delete every key of the bucket', function () {
            spyOn(httpCache, 'delete').and.callThrough();
            var bucket = mocks_spec_1.cacheBucket();
            bucket.add('a');
            bucket.add('b');
            bucket.add('c');
            httpCache.delete(bucket);
            expect(httpCache.delete).toHaveBeenCalledTimes(4);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxJdGF5XFxwcm9qZWN0c1xcb3BlbnNvdXJjZXNcXGh0dHAtY2FjaGVcXHByb2plY3RzXFxuZ25lYXRcXGh0dHAtY2FjaGVcXHNyY1xcbGliXFx0ZXN0XFxodHRwQ2FjaGVNYW5hZ2VyLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFDQSx3RUFBNkQ7QUFJN0QsMkNBQXdIO0FBSXhILFFBQVEsQ0FBQyxrQkFBa0IsRUFBRTtJQUUzQixJQUFJLFNBQTJCLENBQUM7SUFDaEMsSUFBSSxLQUFvQixDQUFDO0lBQ3pCLElBQUksT0FBeUIsQ0FBQztJQUM5QixJQUFJLEtBQXFCLENBQUM7SUFDMUIsSUFBSSxVQUFzQixDQUFDO0lBRTNCLFVBQVUsQ0FBQztRQUNULEtBQUssR0FBRyx5QkFBWSxFQUFFLENBQUM7UUFDdkIsT0FBTyxHQUFHLDZCQUFnQixFQUFFLENBQUM7UUFDN0IsS0FBSyxHQUFHLDJCQUFjLEVBQUUsQ0FBQztRQUN6QixVQUFVLEdBQUcsdUJBQU8sRUFBRSxDQUFDO1FBRXZCLFNBQVMsR0FBRyxJQUFJLDJDQUFnQixDQUM5QixLQUFLLEVBQ0wsT0FBTyxFQUNQLEtBQUssRUFDSCxVQUFVLEVBQ1osbUJBQU0sQ0FDUCxDQUFDO0lBQ0osQ0FBQyxDQUFDLENBQUM7SUFFSCxTQUFTLENBQUM7UUFDUixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsVUFBVSxFQUFFO1FBQ25CLElBQUksR0FBUSxDQUFDO1FBQ2IsSUFBSSxPQUFZLENBQUM7UUFDakIsSUFBSSxhQUFrQixDQUFDO1FBRXZCLFVBQVUsQ0FBQztZQUNULEdBQUcsR0FBRyxLQUFLLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQzVCLE9BQU8sR0FBRyxLQUFLLENBQUMsVUFBVSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQ3ZDLGFBQWEsR0FBRyxLQUFLLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBQzNDLENBQUMsQ0FB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amVjdHNcXG9wZW5zb3VyY2VzXFxodHRwLWNhY2hlXFxwcm9qZWN0c1xcbmduZWF0XFxodHRwLWNhY2hlXFxzcmNcXGxpYlxcdGVzdFxcaHR0cENhY2hlTWFuYWdlci5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7SHR0cENhY2hlR3VhcmR9IGZyb20gJy4uL2h0dHBDYWNoZUd1YXJkJztcbmltcG9ydCB7SHR0cENhY2hlTWFuYWdlcn0gZnJvbSAnLi4vaHR0cENhY2hlTWFuYWdlci5zZXJ2aWNlJztcbmltcG9ydCB7SHR0cENhY2hlU3RvcmFnZX0gZnJvbSAnLi4vaHR0cENhY2hlU3RvcmFnZSc7XG5pbXBvcnQge1JlcXVlc3RzUXVldWV9IGZyb20gJy4uL3JlcXVlc3RzUXVldWUnO1xuaW1wb3J0IHtUVExNYW5hZ2VyfSBmcm9tICcuLi90dGxNYW5hZ2VyJztcbmltcG9ydCB7Y29uZmlnLCByZXF1ZXN0UXVldWUsIGh0dHBDYWNoZVN0b3JhZ2UsIGh0dHBDYWNoZUd1YXJkLCB0dGxNYW5hZ2VyIGFzIG1ha2VUVEwsIGNhY2hlQnVja2V0fSBmcm9tICcuL21vY2tzLnNwZWMnO1xuaW1wb3J0IFNweSA9IGphc21pbmUuU3B5O1xuXG5cbmRlc2NyaWJlKCdIdHRwQ2FjaGVNYW5hZ2VyJywgKCkgPT4ge1xuXG4gIGxldCBodHRwQ2FjaGU6IEh0dHBDYWNoZU1hbmFnZXI7XG4gIGxldCBxdWV1ZTogUmVxdWVzdHNRdWV1ZTtcbiAgbGV0IHN0b3JhZ2U6IEh0dHBDYWNoZVN0b3JhZ2U7XG4gIGxldCBndWFyZDogSHR0cENhY2hlR3VhcmQ7XG4gIGxldCB0dGxNYW5hZ2VyOiBUVExNYW5hZ2VyO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHF1ZXVlID0gcmVxdWVzdFF1ZXVlKCk7XG4gICAgc3RvcmFnZSA9IGh0dHBDYWNoZVN0b3JhZ2UoKTtcbiAgICBndWFyZCA9IGh0dHBDYWNoZUd1YXJkKCk7XG4gICAgdHRsTWFuYWdlciA9IG1ha2VUVEwoKTtcblxuICAgIGh0dHBDYWNoZSA9IG5ldyBIdHRwQ2FjaGVNYW5hZ2VyKFxuICAgICAgcXVldWUsXG4gICAgICBzdG9yYWdlLFxuICAgICAgZ3VhcmQsXG4gICAgICAgIHR0bE1hbmFnZXIsXG4gICAgICBjb25maWdcbiAgICApO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgndmFsaWRhdGUnLCAoKSA9PiB7XG4gICAgbGV0IGhhczogU3B5O1xuICAgIGxldCBpc1ZhbGlkOiBTcHk7XG4gICAgbGV0IHN0b3JhZ2VEZWxldGU6IFNweTtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgaGFzID0gc3B5T24oc3RvcmFnZSwgJ2hhcycpO1xuICAgICAgaXNWYWxpZCA9IHNweU9uKHR0bE1hbmFnZXIsICdpc1ZhbGlkJyk7XG4gICAgICBzdG9yYWdlRGVsZXRlID0gc3B5T24oc3RvcmFnZSwgJ2RlbGV0ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdHJ1ZSB3aGVuIGNhY2hlIGlzIHZhbGlkJywgKCkgPT4ge1xuICAgICAgaGFzLmFuZC5yZXR1cm5WYWx1ZSh0cnVlKTtcbiAgICAgIGlzVmFsaWQuYW5kLnJldHVyblZhbHVlKHRydWUpO1xuICAgICAgZXhwZWN0KGh0dHBDYWNoZS52YWxpZGF0ZSgndmFsaWQga2V5JykpLnRvQmVUcnV0aHkoKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBmYWxzZSB3aGVuIGNhY2hlIGlzIGludmFsaWQnLCAoKSA9PiB7XG4gICAgICBoYXMuYW5kLnJldHVyblZhbHVlKHRydWUpO1xuICAgICAgaXNWYWxpZC5hbmQucmV0dXJuVmFsdWUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGh0dHBDYWNoZS52YWxpZGF0ZSgnaW52YWxpZCBrZXknKSkudG9CZUZhbHN5KCk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2Ugd2hlbiBrZXkgaXMgbm90IGV4aXN0JywgKCkgPT4ge1xuICAgICAgaGFzLmFuZC5yZXR1cm5WYWx1ZShmYWxzZSk7XG4gICAgICBpc1ZhbGlkLmFuZC5yZXR1cm5WYWx1ZSh0cnVlKTtcbiAgICAgIGV4cGVjdChodHRwQ2FjaGUudmFsaWRhdGUoJ2ludmFsaWQga2V5JykpLnRvQmVGYWxzeSgpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgY2FsbCBkZWxldGUgZnJvbSBzdG9yYWdlIHdoZW4ga2V5IGlzIHZhbGlkJywgKCkgPT4ge1xuICAgICAgaGFzLmFuZC5yZXR1cm5WYWx1ZShmYWxzZSk7XG4gICAgICBpc1ZhbGlkLmFuZC5yZXR1cm5WYWx1ZShmYWxzZSk7XG4gICAgICBodHRwQ2FjaGUudmFsaWRhdGUoJ3ZhbGlkIGtleScpO1xuICAgICAgZXhwZWN0KHN0b3JhZ2UuZGVsZXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndmFsaWQga2V5Jyk7XG4gICAgfSlcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2FkZCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGFkZCBrZXkgdG8gYnVja2V0JywgKCkgPT4ge1xuICAgICAgY29uc3QgYnVja2V0ID0gY2FjaGVCdWNrZXQoKTtcbiAgICAgIHNweU9uKGJ1Y2tldCwgJ2FkZCcpO1xuICAgICAgaHR0cENhY2hlLmFkZCgna2V5Jywge30sIHtidWNrZXQ6IGJ1Y2tldH0pO1xuICAgICAgZXhwZWN0KGJ1Y2tldC5hZGQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdrZXknKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHNldCB0aGUga2V5JywgKCkgPT4ge1xuICAgICAgc3B5T24oc3RvcmFnZSwgJ3NldCcpO1xuICAgICAgc3B5T24odHRsTWFuYWdlciwgJ3NldCcpO1xuICAgICAgc3B5T24ocXVldWUsICdkZWxldGUnKTtcbiAgICAgIGh0dHBDYWNoZS5hZGQoJ2tleScsIHt9LCB7fSk7XG4gICAgICBleHBlY3Qoc3RvcmFnZS5zZXQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdCh0dGxNYW5hZ2VyLnNldCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KHF1ZXVlLmRlbGV0ZSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZGVsZXRlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGVsZXRlIHRoZSBrZXkgZnJvbSBzdG9yYWdlIGFuZCB0dGwnLCAoKSA9PiB7XG4gICAgICBzcHlPbihzdG9yYWdlLCAnZGVsZXRlJyk7XG4gICAgICBzcHlPbih0dGxNYW5hZ2VyLCAnZGVsZXRlJyk7XG4gICAgICBodHRwQ2FjaGUuZGVsZXRlKCdrZXknKTtcbiAgICAgIGV4cGVjdChzdG9yYWdlLmRlbGV0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2tleScpO1xuICAgICAgZXhwZWN0KHR0bE1hbmFnZXIuZGVsZXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgna2V5Jyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBjbGVhciBhIGdpdmVuIGNhY2hlIGJ1Y2tldCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGJ1Y2tldCA9IGNhY2hlQnVja2V0KCk7XG4gICAgICBzcHlPbihidWNrZXQsICdjbGVhcicpO1xuICAgICAgaHR0cENhY2hlLmRlbGV0ZShidWNrZXQpO1xuICAgICAgZXhwZWN0KGJ1Y2tldC5jbGVhcikudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgZGVsZXRlIGV2ZXJ5IGtleSBvZiB0aGUgYnVja2V0JywgKCkgPT4ge1xuICAgICAgc3B5T24oaHR0cENhY2hlLCAnZGVsZXRlJykuYW5kLmNhbGxUaHJvdWdoKCk7XG4gICAgICBjb25zdCBidWNrZXQgPSBjYWNoZUJ1Y2tldCgpO1xuICAgICAgYnVja2V0LmFkZCgnYScpO1xuICAgICAgYnVja2V0LmFkZCgnYicpO1xuICAgICAgYnVja2V0LmFkZCgnYycpO1xuICAgICAgaHR0cENhY2hlLmRlbGV0ZShidWNrZXQpO1xuICAgICAgZXhwZWN0KGh0dHBDYWNoZS5kZWxldGUpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcyg0KTtcbiAgICB9KTtcbiAgfSk7XG5cbn0pO1xuIl0sInZlcnNpb24iOjN9